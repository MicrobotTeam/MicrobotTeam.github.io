'use strict';Vue.component('chat-block',{template:'#chat-block-template',props:{chatItem:Object,userList:Array}}),Vue.component('article-block',{template:'#article-block-template',props:{articleItem:Object,userList:Array,itemIndex:Number},data:function data(){return{showUserModal:!1,showUserTimer:null}},computed:{authorRef:function authorRef(){var d=this,c={username:'',nickname:'\u533F\u540D',blog_link:''};return this.userList.map(function(g){g.username===d.articleItem.author&&(c=g)}),c}},methods:{hoverUserInfoHandler:function hoverUserInfoHandler(c){var d=this;c?(clearTimeout(this.showUserTimer),this.showUserModal=!0):this.showUserTimer=setTimeout(function(){d.showUserModal=!1},200)}}}),Vue.component('user-modal',{template:'#user-modal-template',props:{authorRef:Object}}),new Vue({el:'#app',data:{loading:!1,apiPath:{HOST:'/data',GET_ARTICLES:'/article.json',GET_USERS:'/users.json'},userList:[],chatList:[]},methods:{groupBy:function groupBy(c,d){var g={};return c.forEach(function(h){var i=d(h);g[i]=g[i]||[],g[i].push(h)}),Object.keys(g).map(function(h){return{key:h,value:g[h]}})},ajax:function ajax(c,d){var g=new XMLHttpRequest;g.open('get',c,!0),g.send(),g.onreadystatechange=function(){if(4==g.readyState&&(200<=g.status&&300>g.status||304==g.status)){var h={};try{h='string'==typeof g.responseText?JSON.parse(g.responseText):g.responseText,d(h)}catch(i){console.log(i)}}}},getArticleData:function getArticleData(){var c=this;this.loading=!0,this.ajax(''+this.apiPath.HOST+this.apiPath.GET_ARTICLES,function(d){var g=d;g.sort(function(i,j){var k='number'==typeof i.time?1e3*i.time:new Date(i.time.replace('-','/')).getTime(),l='number'==typeof j.time?1e3*j.time:new Date(j.time.replace('-','/')).getTime();return-(k-l)});var h=c.groupBy(g,function(i){var j='number'==typeof i.time?new Date(1e3*i.time):new Date(i.time.replace('-','/')),k=j.getFullYear()+'-'+(j.getMonth()+1);return k});c.chatList=h.map(function(i){return{date:i.key,articleList:i.value}}),c.loading=!1})},getUsersData:function getUsersData(){var c=this;this.ajax(''+this.apiPath.HOST+this.apiPath.GET_USERS,function(d){c.userList=d})}},created:function created(){this.getUsersData(),this.getArticleData()},mounted:function mounted(){particlesJS('particles-js',{particles:{color:'#ddd',shape:'triangle',opacity:0.3,size:1,size_random:!0,nb:150,line_linked:{enable_auto:!0,distance:100,color:'#ddd',opacity:1,width:1,condensed_mode:{enable:!0,rotateX:600,rotateY:600}},anim:{enable:!0,speed:1}},interactivity:{enable:!0,mouse:{distance:250},detect_on:'canvas',mode:'grab',line_linked:{opacity:.5},events:{onclick:{enable:!0,mode:'push',nb:4}}},retina_detect:!0})}});